═══════════════════════════════════════════════════
  🥬 蔬菜公司Excel助手 - 菜品匹配规则说明
═══════════════════════════════════════════════════

📌 匹配原则
═══════════════════════════════════════════════════

系统采用"汉字完全匹配 + 编号模糊匹配"的智能算法：

✓ 汉字部分：必须完全一致
✓ 编号部分：支持模糊匹配或不匹配

═══════════════════════════════════════════════════

📝 详细规则
═══════════════════════════════════════════════════

1. 汉字提取规则
   - 提取菜品名开头的连续汉字作为"菜品主名"
   - 后续的数字、字母、"号"、"级"等作为"编号"
   
   示例：
   "尖椒1号"   -> 汉字："尖椒"  编号："1号"
   "黄瓜A级"   -> 汉字："黄瓜"  编号："A级"
   "茄子123"   -> 汉字："茄子"  编号："123"
   "胡萝卜"     -> 汉字："胡萝卜" 编号：""

2. 匹配优先级（从高到低）
   
   ① 完全匹配（汉字+编号都一致）
      订单：尖椒1号  ←→  定价表：尖椒1号  ✓✓✓
   
   ② 编号包含匹配（汉字一致，编号部分包含）
      订单：尖椒1号  ←→  定价表：尖椒123号  ✓✓
   
   ③ 仅汉字匹配（汉字一致，编号不同或无编号）
      订单：尖椒     ←→  定价表：尖椒1号  ✓
      订单：尖椒2号  ←→  定价表：尖椒1号  ✓
      订单：尖椒1号  ←→  定价表：尖椒     ✓

═══════════════════════════════════════════════════

💡 实际应用示例
═══════════════════════════════════════════════════

假设定价表包含：
  - 胡萝卜：¥5.0
  - 尖椒1号：¥8.0
  - 尖椒2号：¥9.0
  - 黄瓜A级：¥6.0
  - 茄子123：¥7.5

订单匹配结果：

┌─────────────┬──────────────┬────────┬──────────┐
│  订单菜品    │ 匹配类型      │ 匹配到  │  价格    │
├─────────────┼──────────────┼────────┼──────────┤
│ 胡萝卜       │ 完全匹配      │ 胡萝卜  │ ¥5.0    │
│ 尖椒1号      │ 完全匹配      │ 尖椒1号 │ ¥8.0    │
│ 尖椒2号      │ 完全匹配      │ 尖椒2号 │ ¥9.0    │
│ 尖椒         │ 汉字匹配      │ 尖椒1号 │ ¥8.0    │
│ 尖椒3号      │ 汉字匹配      │ 尖椒1号 │ ¥8.0    │
│ 黄瓜A级      │ 完全匹配      │ 黄瓜A级 │ ¥6.0    │
│ 黄瓜         │ 汉字匹配      │ 黄瓜A级 │ ¥6.0    │
│ 黄瓜B级      │ 汉字匹配      │ 黄瓜A级 │ ¥6.0    │
│ 茄子         │ 汉字匹配      │ 茄子123 │ ¥7.5    │
│ 茄子123      │ 完全匹配      │ 茄子123 │ ¥7.5    │
│ 茄子456      │ 汉字匹配      │ 茄子123 │ ¥7.5    │
│ 土豆         │ 无匹配        │ -       │ 000000  │
└─────────────┴──────────────┴────────┴──────────┘

═══════════════════════════════════════════════════

⚠️ 注意事项
═══════════════════════════════════════════════════

1. 如果定价表有多个相同汉字的菜品（如：尖椒1号、尖椒2号）
   - 订单"尖椒1号"会匹配到"尖椒1号"（完全匹配）
   - 订单"尖椒"会匹配到第一个遇到的（尖椒1号）

2. 建议定价表和进价表使用相同的菜品命名
   - 这样可以确保价格匹配的一致性

3. 如果菜品在定价表或进价表中找不到
   - 该菜品的价格会显示为"000000"
   - 利润计算时该条记录会被标记

4. 命名建议：
   - 主菜品名用汉字：胡萝卜、尖椒、黄瓜
   - 规格编号放后面：尖椒1号、黄瓜A级、茄子123

═══════════════════════════════════════════════════

🔧 自定义修改
═══════════════════════════════════════════════════

如需修改匹配规则，请编辑 matcher.py 文件中的：
- extract_chinese_and_number() 函数（提取汉字和编号）
- find_matching_price() 函数（匹配逻辑）

═══════════════════════════════════════════════════
